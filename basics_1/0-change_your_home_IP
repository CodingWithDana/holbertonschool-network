#!/usr/bin/env bash
# Configures /etc/hosts:
# - localhost -> 127.0.0.2
# - facebook.com -> 8.8.8.8

HOSTS="/etc/hosts"

# Read the current hosts file FIRST (avoid read/write at same time)
old_hosts="$(cat "$HOSTS")"

# Build the new file content
{
    echo "127.0.0.2 localhost"
    echo "8.8.8.8 facebook.com"

    # Keep everything else, but remove:
    # - any IPv4 line that contains 'localhost'
    # - any line that contains 'facebook.com'
    printf "%s\n" "$old_hosts" | grep -vE '(^127\.[0-9.]+[[:space:]].*\blocalhost\b)|(\bfacebook\.com\b)' || true
} | tee "$HOSTS" >/dev/null
